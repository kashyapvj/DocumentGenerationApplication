@using DocumentGenerationApplication.Models.Enums
@model IEnumerable<DocumentGenerationApplication.Models.Tables.EmployeeDetails>

@{
    Layout = "_Layout";
    var rowNumber = 1;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Appointment Letters</title>

    <style>
        body {
            font-size: 0.9rem;
        }

        h4 {
            font-weight: 600;
            margin-bottom: 1rem;
            color: #333;
        }

        /* Table container */
        .table-container {
            max-width: 95%;
            margin: 0 auto;
        }

        /* Smaller, clean table */
        table.table {
            font-size: 0.875rem; /* slightly smaller font */
            border-collapse: collapse;
        }

            table.table th, table.table td {
                padding: 0.5rem 0.75rem;
                vertical-align: middle;
            }

        /* Sticky header for large tables */
        .bootstrap-table .fixed-table-container .fixed-table-header {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        /* Button styling */
        .btn-custom {
            background-color: #7066E0;
            color: white;
            border: none;
            transition: 0.3s;
        }

            .btn-custom:hover {
                background-color: #5a50d0;
            }
    </style>
</head>
<body>
    <h3>Appointment Letters Generated</h3>

    <div class="table-container">

        <table id="offerLettersTable"
               class="table table-bordered table-striped table-sm"
               data-toggle="table"
               data-search="true"
               data-pagination="true"
               data-page-size="10"
               data-page-list="[5, 10, 25, 50, 100, All]"
               data-show-columns="true"
               data-show-toggle="true"
               data-show-export="true"
               data-export-types='["excel", "csv", "txt"]'
               data-click-to-select="true"
               data-single-select="false"
               data-id-field="id"
               data-export-data-type="selected"
               data-locale="en-US">
            <thead class="table-light">
                <tr>
                    <th data-field="state" data-checkbox="true"></th>
                    <th>No.</th>
                    <th data-sortable="true">@Html.DisplayNameFor(model => model.EmployeeId)</th>
                    <th data-sortable="true">@Html.DisplayNameFor(model => model.RefNo)</th>
                    <th data-sortable="true">@Html.DisplayNameFor(model => model.EmployeeName)</th>
                    <th data-sortable="true">@Html.DisplayNameFor(model => model.JoiningDate)</th>
                    <th data-sortable="true">@Html.DisplayNameFor(model => model.Email)</th>
                    <th>@Html.DisplayNameFor(model => model.Status)</th>
                    <th>Employee Type</th>
                    <th>Address Line 1</th>
                    <th>Address Line 2</th>
                    <th>Address Line 3</th>
                    <th>@Html.DisplayNameFor(model => model.JobLocation)</th>
                    <th>@Html.DisplayNameFor(model => model.MobileNumber)</th>
                    @* <th>@Html.DisplayNameFor(model => model.OfferValidTill)</th> *@
                    <th>Band</th>
                    <th>Grade</th>
                    <th>Department</th>
                    <th>Designation</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td></td>
                        <td>@rowNumber</td>
                        <td>@item.EmployeeId</td>
                        <td>@item.RefNo</td>
                        <td>@item.EmployeeName</td>
                        <td>@item.JoiningDate.ToString("dd-MM-yyyy")</td>
                        <td>@item.Email</td>
                        <td>
                            @if (item.Status == EmployeeStatus.Joined)
                            {
                                <span style="color: green; font-weight: bold;">@item.Status</span>
                            }
                            else if (item.Status == EmployeeStatus.Backout)
                            {
                                <span style="color: red; font-weight: bold;">@item.Status</span>
                            }
                            else if (item.Status == EmployeeStatus.Delayed)
                            {
                                <span style="color: goldenrod; font-weight: bold;">@item.Status</span>
                            }
                    </td>
                    <td>
                        @(item.DocumentType == 1 || item.DocumentType == 3
                                                ? "Experienced"
                                                : (item.DocumentType == 2 || item.DocumentType == 4
                                                ? "Fresher"
                                                : ""))
                    </td>
                    <td>@item.Address_Line1</td>
                    <td>@item.Address_Line2</td>
                    <td>@item.Address_Line3</td>
                    <td>@item.JobLocation</td>
                    <td>@item.MobileNumber</td>
                    @* <td>@item.OfferValidTill?.ToString("dd-MM-yyyy")</td> *@
                    <td>@item.Band?.BandName</td>
                    <td>@item.Grade?.GradeName</td>
                    <td>@item.Department?.DepartmentName</td>
                    <td>@item.Designation?.DesignationName</td>
                    <td>
                        <a asp-controller="Employee"
                           asp-action="DownloadOfferLetterPdf"
                           asp-route-id="@item.Id"
                           asp-route-status="true"
                           class="btn btn-sm btn-custom mb-1">Download pdf</a>

                            <a asp-controller="Employee"
                               asp-action="DownloadOfferLetterWord"
                               asp-route-id="@item.Id"
                               asp-route-status="true"
                               class="btn btn-sm btn-custom mb-1">Download word</a>

                    </td>
                </tr>
                                rowNumber++;
                }
            </tbody>
        </table>
    </div>
</body>
</html>



